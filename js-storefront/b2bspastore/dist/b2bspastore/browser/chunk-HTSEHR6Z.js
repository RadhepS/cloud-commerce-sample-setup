import{c as S}from"./chunk-6I5NU3TJ.js";import{f as Qe}from"./chunk-APA5RVE3.js";import{B as Oe,Ca as He,E as Pe,Ea as Ze,G as ke,H as Ve,Ma as Ye,Oa as Ke,Tb as Je,aa as ze,b as De,c as T,d as Ue,e as je,l as Ae,p as we,pa as qe,q as Le,s as $e,x as Ge}from"./chunk-F5NBEN52.js";import{Ae as xe,Db as ee,Ea as Z,Eb as f,Ee as _e,Fa as Y,Fb as x,Fc as E,Fd as le,Ff as Re,Ga as K,Gb as te,I as P,Jc as se,Jg as Be,Me as I,Mf as Te,N as k,Ne as ve,Nf as Ne,Ob as re,Pb as v,Pc as ae,R as V,Re as he,Sa as r,Ta as J,Tf as Ee,Uf as A,Vb as s,Wb as a,Yf as Ie,Zd as pe,Ze as Fe,_b as ie,ae as me,bb as g,cb as Q,cf as ye,db as n,df as be,ee as de,f as $,gf as Ce,i as G,ia as M,ie as ue,jb as d,kb as p,la as B,lb as l,lg as Se,mb as D,mg as Me,nb as U,pb as W,qa as C,ra as y,rb as X,s as O,sa as z,sb as m,ta as u,tc as oe,ua as q,vb as _,vd as ce,we as ge,xd as j,ya as H,yc as ne,ye as fe,za as b}from"./chunk-Q7YDE2H2.js";var L=e=>({ariaLabel:e}),pt=()=>({cxRoute:"login"}),F=e=>({label:e});function mt(e,t){if(e&1&&(l(0,"cx-form-errors",24),s(1,"cxTranslate")),e&2){let o=m(2);n("translationParams",v(4,F,a(1,2,"userRegistrationForm.fields.firstName.label")))("control",o.registerForm.get("firstName"))}}function dt(e,t){if(e&1&&l(0,"cx-form-errors",16),e&2){let o=m(2);n("control",o.registerForm.get("firstName"))}}function ut(e,t){if(e&1&&(l(0,"cx-form-errors",24),s(1,"cxTranslate")),e&2){let o=m(2);n("translationParams",v(4,F,a(1,2,"userRegistrationForm.fields.lastName.label")))("control",o.registerForm.get("lastName"))}}function gt(e,t){if(e&1&&l(0,"cx-form-errors",16),e&2){let o=m(2);n("control",o.registerForm.get("lastName"))}}function ft(e,t){if(e&1&&(l(0,"cx-form-errors",24),s(1,"cxTranslate")),e&2){let o=m(2);n("translationParams",v(4,F,a(1,2,"userRegistrationForm.fields.companyName.label")))("control",o.registerForm.get("companyName"))}}function xt(e,t){if(e&1&&l(0,"cx-form-errors",16),e&2){let o=m(2);n("control",o.registerForm.get("companyName"))}}function _t(e,t){if(e&1&&(l(0,"cx-form-errors",24),s(1,"cxTranslate")),e&2){let o=m(2);n("translationParams",v(4,F,a(1,2,"userRegistrationForm.fields.email.label")))("control",o.registerForm.get("email"))}}function vt(e,t){if(e&1&&l(0,"cx-form-errors",16),e&2){let o=m(2);n("control",o.registerForm.get("email"))}}function ht(e,t){if(e&1&&(l(0,"cx-form-errors",24),s(1,"cxTranslate")),e&2){let o=m(4);n("translationParams",v(4,F,a(1,2,"userRegistrationForm.fields.country.label")))("control",o.registerForm.get("country.isocode"))}}function Ft(e,t){if(e&1&&l(0,"cx-form-errors",16),e&2){let o=m(4);n("control",o.registerForm.get("country.isocode"))}}function yt(e,t){if(e&1&&(d(0,"label")(1,"span",4),f(2),s(3,"cxTranslate"),p(),l(4,"ng-select",27),s(5,"cxTranslate"),s(6,"cxTranslate"),g(7,ht,2,6,"cx-form-errors",8)(8,Ft,1,1,"cx-form-errors",9),p()),e&2){let o=m().ngIf;r(2),x(a(3,8,"userRegistrationForm.fields.country.label")),r(2),_("placeholder",a(5,10,"userRegistrationForm.fields.country.placeholder")),n("searchable",!0)("clearable",!1)("items",o)("cxNgSelectA11y",v(14,L,a(6,12,"userRegistrationForm.fields.country.label"))),r(3),n("cxFeature","formErrorsDescriptiveMessages"),r(),n("cxFeature","!formErrorsDescriptiveMessages")}}function bt(e,t){if(e&1&&(D(0,25),g(1,yt,9,16,"label",26),U()),e&2){let o=t.ngIf;r(),n("ngIf",o.length!==0)}}function Ct(e,t){if(e&1&&(l(0,"cx-form-errors",24),s(1,"cxTranslate")),e&2){let o=m(2);n("translationParams",v(4,F,a(1,2,"userRegistrationForm.fields.addressLine.label")))("control",o.registerForm.get("line1"))}}function Rt(e,t){if(e&1&&l(0,"cx-form-errors",16),e&2){let o=m(2);n("control",o.registerForm.get("line1"))}}function Tt(e,t){if(e&1&&(l(0,"cx-form-errors",24),s(1,"cxTranslate")),e&2){let o=m(2);n("translationParams",v(4,F,a(1,2,"userRegistrationForm.fields.postalCode.label")))("control",o.registerForm.get("postalCode"))}}function Nt(e,t){if(e&1&&l(0,"cx-form-errors",16),e&2){let o=m(2);n("control",o.registerForm.get("postalCode"))}}function Et(e,t){if(e&1&&(l(0,"cx-form-errors",24),s(1,"cxTranslate")),e&2){let o=m(4);n("translationParams",v(4,F,a(1,2,"userRegistrationForm.fields.state.label")))("control",o.registerForm.get("region.isocode"))}}function It(e,t){if(e&1&&l(0,"cx-form-errors",16),e&2){let o=m(4);n("control",o.registerForm.get("region.isocode"))}}function St(e,t){if(e&1&&(d(0,"label")(1,"span",4),f(2),s(3,"cxTranslate"),p(),l(4,"ng-select",29),s(5,"cxTranslate"),s(6,"cxTranslate"),g(7,Et,2,6,"cx-form-errors",8)(8,It,1,1,"cx-form-errors",9),p()),e&2){let o=m().ngIf;r(2),x(a(3,8,"userRegistrationForm.fields.state.label")),r(2),_("placeholder",a(5,10,"userRegistrationForm.fields.state.placeholder")),n("searchable",!0)("clearable",!1)("items",o)("cxNgSelectA11y",v(14,L,a(6,12,"userRegistrationForm.fields.state.label"))),r(3),n("cxFeature","formErrorsDescriptiveMessages"),r(),n("cxFeature","!formErrorsDescriptiveMessages")}}function Mt(e,t){if(e&1&&(D(0,28),g(1,St,9,16,"label",26),U()),e&2){let o=t.ngIf;r(),n("ngIf",o.length!==0)}}function Bt(e,t){if(e&1&&(l(0,"cx-form-errors",24),s(1,"cxTranslate")),e&2){let o=m(2);n("translationParams",v(4,F,a(1,2,"userRegistrationForm.fields.phoneNumber.label")))("control",o.registerForm.get("phoneNumber"))}}function Dt(e,t){if(e&1&&l(0,"cx-form-errors",16),e&2){let o=m(2);n("control",o.registerForm.get("phoneNumber"))}}function Ut(e,t){if(e&1&&(l(0,"cx-form-errors",24),s(1,"cxTranslate")),e&2){let o=m(2);n("translationParams",v(4,F,a(1,2,"userRegistrationForm.fields.message.label")))("control",o.registerForm.get("message"))}}function jt(e,t){if(e&1&&l(0,"cx-form-errors",16),e&2){let o=m(2);n("control",o.registerForm.get("message"))}}function At(e,t){if(e&1){let o=W();d(0,"section"),l(1,"div",2),s(2,"cxTranslate"),d(3,"form",3),X("ngSubmit",function(){Z(o);let c=m();return Y(c.submit())}),d(4,"label")(5,"span",4),f(6),s(7,"cxTranslate"),p(),l(8,"ng-select",5),s(9,"cxTranslate"),s(10,"async"),s(11,"cxTranslate"),p(),d(12,"label")(13,"span",6),f(14),s(15,"cxTranslate"),p(),l(16,"input",7),s(17,"cxTranslate"),g(18,mt,2,6,"cx-form-errors",8)(19,dt,1,1,"cx-form-errors",9),p(),d(20,"label")(21,"span",6),f(22),s(23,"cxTranslate"),p(),l(24,"input",10),s(25,"cxTranslate"),g(26,ut,2,6,"cx-form-errors",8)(27,gt,1,1,"cx-form-errors",9),p(),d(28,"label")(29,"span",6),f(30),s(31,"cxTranslate"),p(),l(32,"input",11),s(33,"cxTranslate"),g(34,ft,2,6,"cx-form-errors",8)(35,xt,1,1,"cx-form-errors",9),p(),d(36,"label")(37,"span",6),f(38),s(39,"cxTranslate"),p(),l(40,"input",12),s(41,"cxTranslate"),g(42,_t,2,6,"cx-form-errors",8)(43,vt,1,1,"cx-form-errors",9),p(),g(44,bt,2,1,"ng-container",13),s(45,"async"),d(46,"label")(47,"span",4),f(48),s(49,"cxTranslate"),p(),l(50,"input",14),s(51,"cxTranslate"),g(52,Ct,2,6,"cx-form-errors",8)(53,Rt,1,1,"cx-form-errors",9),p(),d(54,"label")(55,"span",4),f(56),s(57,"cxTranslate"),p(),l(58,"input",15),s(59,"cxTranslate"),l(60,"cx-form-errors",16),p(),d(61,"label")(62,"span",4),f(63),s(64,"cxTranslate"),p(),l(65,"input",17),s(66,"cxTranslate"),l(67,"cx-form-errors",16),p(),d(68,"label")(69,"span",4),f(70),s(71,"cxTranslate"),p(),l(72,"input",18),s(73,"cxTranslate"),g(74,Tt,2,6,"cx-form-errors",8)(75,Nt,1,1,"cx-form-errors",9),p(),g(76,Mt,2,1,"ng-container",19),s(77,"async"),d(78,"label")(79,"span",4),f(80),s(81,"cxTranslate"),p(),l(82,"input",20),s(83,"cxTranslate"),g(84,Bt,2,6,"cx-form-errors",8)(85,Dt,1,1,"cx-form-errors",9),p(),d(86,"label")(87,"span",4),f(88),s(89,"cxTranslate"),p(),l(90,"textarea",21),s(91,"cxTranslate"),g(92,Ut,2,6,"cx-form-errors",8)(93,jt,1,1,"cx-form-errors",9),p(),d(94,"button",22),f(95),s(96,"cxTranslate"),p(),d(97,"a",23),s(98,"cxUrl"),f(99),s(100,"cxTranslate"),p()()()}if(e&2){let o=m();r(),Q("aria-label",a(2,51,"common.loaded")),r(2),n("formGroup",o.registerForm),r(3),x(a(7,53,"userRegistrationForm.fields.titleCode.label")),r(2),_("placeholder",a(9,55,"userRegistrationForm.fields.titleCode.placeholder")),n("searchable",!1)("clearable",!1)("items",a(10,57,o.titles$))("cxNgSelectA11y",v(111,L,a(11,59,"userRegistrationForm.fields.titleCode.label"))),r(6),x(a(15,61,"userRegistrationForm.fields.firstName.label")),r(2),_("placeholder",a(17,63,"userRegistrationForm.fields.firstName.placeholder")),r(2),n("cxFeature","formErrorsDescriptiveMessages"),r(),n("cxFeature","!formErrorsDescriptiveMessages"),r(3),x(a(23,65,"userRegistrationForm.fields.lastName.label")),r(2),_("placeholder",a(25,67,"userRegistrationForm.fields.lastName.placeholder")),r(2),n("cxFeature","formErrorsDescriptiveMessages"),r(),n("cxFeature","!formErrorsDescriptiveMessages"),r(3),x(a(31,69,"userRegistrationForm.fields.companyName.label")),r(2),_("placeholder",a(33,71,"userRegistrationForm.fields.companyName.placeholder")),r(2),n("cxFeature","formErrorsDescriptiveMessages"),r(),n("cxFeature","!formErrorsDescriptiveMessages"),r(3),x(a(39,73,"userRegistrationForm.fields.email.label")),r(2),_("placeholder",a(41,75,"userRegistrationForm.fields.email.placeholder")),r(2),n("cxFeature","formErrorsDescriptiveMessages"),r(),n("cxFeature","!formErrorsDescriptiveMessages"),r(),n("ngIf",a(45,77,o.countries$)),r(4),x(a(49,79,"userRegistrationForm.fields.addressLine.label")),r(2),_("placeholder",a(51,81,"userRegistrationForm.fields.addressLine.placeholder")),r(2),n("cxFeature","formErrorsDescriptiveMessages"),r(),n("cxFeature","!formErrorsDescriptiveMessages"),r(3),x(a(57,83,"userRegistrationForm.fields.secondAddressLine.label")),r(2),_("placeholder",a(59,85,"userRegistrationForm.fields.secondAddressLine.placeholder")),r(2),n("control",o.registerForm.get("line2")),r(3),x(a(64,87,"userRegistrationForm.fields.city.label")),r(2),_("placeholder",a(66,89,"userRegistrationForm.fields.city.label")),r(2),n("control",o.registerForm.get("town")),r(3),x(a(71,91,"userRegistrationForm.fields.postalCode.label")),r(2),_("placeholder",a(73,93,"userRegistrationForm.fields.postalCode.placeholder")),r(2),n("cxFeature","formErrorsDescriptiveMessages"),r(),n("cxFeature","!formErrorsDescriptiveMessages"),r(),n("ngIf",a(77,95,o.regions$)),r(4),x(a(81,97,"userRegistrationForm.fields.phoneNumber.label")),r(2),_("placeholder",a(83,99,"userRegistrationForm.fields.phoneNumber.placeholder")),r(2),n("cxFeature","formErrorsDescriptiveMessages"),r(),n("cxFeature","!formErrorsDescriptiveMessages"),r(3),x(a(89,101,"userRegistrationForm.fields.message.label")),r(2),_("placeholder",a(91,103,"userRegistrationForm.fields.message.placeholder")),r(2),n("cxFeature","formErrorsDescriptiveMessages"),r(),n("cxFeature","!formErrorsDescriptiveMessages"),r(2),te(" ",a(96,105,"userRegistrationForm.formSubmitButtonLabel")," "),r(2),n("routerLink",a(98,107,re(113,pt))),r(2),x(a(100,109,"userRegistrationForm.goToLoginButtonLabel"))}}function wt(e,t){e&1&&(d(0,"div",30),l(1,"cx-spinner"),p())}var Xe=(()=>{let t=class t{buildForm(){return this.formBuilder.group({titleCode:[null],firstName:["",T.required],lastName:["",T.required],companyName:["",T.required],email:["",[T.required,Je.emailValidator]],country:this.formBuilder.group({isocode:[null]}),line1:[""],line2:[""],town:[""],region:this.formBuilder.group({isocode:[null]}),postalCode:[""],phoneNumber:[""],message:[""]})}get form(){return this._form}get countryControl(){return this.form.get("country.isocode")}get regionControl(){return this.form.get("region.isocode")}constructor(i,c,h,R,st,at,ct,lt){this.userRegisterFacade=i,this.userAddressService=c,this.organizationUserRegistrationFacade=h,this.translationService=R,this.globalMessageService=st,this.authConfigService=at,this.routingService=ct,this.formBuilder=lt,this._form=this.buildForm()}getTitles(){return this.userRegisterFacade.getTitles()}getCountries(){return this.userAddressService.getDeliveryCountries().pipe(B(i=>{Object.keys(i).length===0&&this.userAddressService.loadDeliveryCountries()}))}getRegions(){let i=[];return this.countryControl?.valueChanges.pipe(P(c=>!!c),M(c=>(this.regionControl?.reset(),this.userAddressService.getRegions(c))))??O(i)}buildMessageContent(i){return this.translationService.translate("userRegistrationForm.messageToApproverTemplate",{phoneNumber:i.get("phoneNumber")?.value,addressLine:i.get("line1")?.value,secondAddressLine:i.get("line2")?.value,city:i.get("city")?.value,state:i.get("region")?.get("isocode")?.value,postalCode:i.get("postalCode")?.value,country:i.get("country")?.get("isocode")?.value,companyName:i.get("companyName")?.value,message:i.get("message")?.value})}displayGlobalMessage(){return this.globalMessageService.add({key:"userRegistrationForm.successFormSubmitMessage"},I.MSG_TYPE_CONFIRMATION)}redirectToLogin(){this.authConfigService.getOAuthFlow()===pe.ResourceOwnerPasswordFlow&&this.routingService.go({cxRoute:"login"})}registerUser(i){return this.buildMessageContent(i).pipe(V(1),M(c=>this.organizationUserRegistrationFacade.registerUser({titleCode:i.get("titleCode")?.value,firstName:i.get("firstName")?.value,lastName:i.get("lastName")?.value,email:i.get("email")?.value,message:c})),B(()=>{this.displayGlobalMessage(),this.redirectToLogin(),i.reset()}))}};t.\u0275fac=function(c){return new(c||t)(u(Qe),u(Be),u(S),u(Re),u(ve),u(me),u(ue),u(Oe))},t.\u0275prov=C({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})(),Lt=(()=>{let t=class t{constructor(i){this.userRegistrationFormService=i,this.titles$=this.userRegistrationFormService.getTitles(),this.countries$=this.userRegistrationFormService.getCountries(),this.regions$=this.userRegistrationFormService.getRegions(),this.registerForm=this.userRegistrationFormService.form,this.isLoading$=new G(!1),this.subscriptions=new $}submit(){this.registerForm.valid?(this.isLoading$.next(!0),this.subscriptions.add(this.userRegistrationFormService.registerUser(this.registerForm).subscribe({complete:()=>this.isLoading$.next(!1),error:()=>this.isLoading$.next(!1)}))):this.registerForm.markAllAsTouched()}ngOnDestroy(){this.subscriptions.unsubscribe()}};t.\u0275fac=function(c){return new(c||t)(J(Xe))},t.\u0275cmp=H({type:t,selectors:[["cx-user-registration-form"]],decls:4,vars:4,consts:[["loading",""],[4,"ngIf","ngIfElse"],["role","status"],[3,"ngSubmit","formGroup"],[1,"label-content"],["id","title-code-select","formControlName","titleCode","bindLabel","name","bindValue","code",3,"searchable","clearable","items","placeholder","cxNgSelectA11y"],[1,"label-content","required"],["required","true","type","text","name","firstname","formControlName","firstName",1,"form-control",3,"placeholder"],[3,"translationParams","control",4,"cxFeature"],[3,"control",4,"cxFeature"],["required","true","type","text","name","lastname","formControlName","lastName",1,"form-control",3,"placeholder"],["required","true","type","text","name","companyName","formControlName","companyName",1,"form-control",3,"placeholder"],["required","true","type","email","name","email","formControlName","email",1,"form-control",3,"placeholder"],["formGroupName","country",4,"ngIf"],["type","text","formControlName","line1",1,"form-control",3,"placeholder"],["type","text","formControlName","line2",1,"form-control",3,"placeholder"],[3,"control"],["type","text","formControlName","town",1,"form-control",3,"placeholder"],["type","text","formControlName","postalCode",1,"form-control",3,"placeholder"],["formGroupName","region",4,"ngIf"],["type","tel","formControlName","phoneNumber",1,"form-control",3,"placeholder"],["formControlName","message","rows","5",1,"form-control",3,"placeholder"],["type","submit",1,"btn","btn-block","btn-primary"],[1,"cx-login-link","btn-link",3,"routerLink"],[3,"translationParams","control"],["formGroupName","country"],[4,"ngIf"],["id","country-select","formControlName","isocode","bindLabel","name","bindValue","isocode",1,"country-select",3,"searchable","clearable","items","placeholder","cxNgSelectA11y"],["formGroupName","region"],["formControlName","isocode","bindLabel","name","bindValue","isocode","id","region-select",1,"region-select",3,"searchable","clearable","items","placeholder","cxNgSelectA11y"],[1,"cx-spinner"]],template:function(c,h){if(c&1&&(g(0,At,101,114,"section",1),s(1,"async"),g(2,wt,2,0,"ng-template",null,0,ie)),c&2){let R=ee(3);n("ngIf",!a(1,2,h.isLoading$))("ngIfElse",R)}},dependencies:[oe,Ae,De,Ue,je,Ge,we,$e,Le,ce,ze,He,ke,Ye,Fe,ne,Te,Se],encapsulation:2,changeDetection:0});let e=t;return e})(),$t=(()=>{let t=class t{};t.\u0275fac=function(c){return new(c||t)},t.\u0275mod=b({type:t}),t.\u0275inj=y({providers:[Xe],imports:[E,Pe,j,Ne,Me,qe,Ze,Ve,Ke,ye.withConfig({cmsComponents:{OrganizationUserRegistrationComponent:{component:Lt,guards:[he]}}}),be]});let e=t;return e})(),et=(()=>{let t=class t{};t.\u0275fac=function(c){return new(c||t)},t.\u0275mod=b({type:t}),t.\u0275inj=y({imports:[j,$t]});let e=t;return e})();var rt=new z("OrganizationUserRegistrationSerializer"),N=class{},it=(()=>{let t=class t{constructor(i){this.adapter=i}registerUser(i){return this.adapter.registerUser(i)}};t.\u0275fac=function(c){return new(c||t)(u(N))},t.\u0275prov=C({token:t,factory:t.\u0275fac});let e=t;return e})(),tt=(()=>{let t=class t{constructor(i,c){this.userRegistrationConnector=i,this.command=c,this.registerOrganizationUserCommand=this.command.create(h=>this.userRegistrationConnector.registerUser(h.userData))}registerUser(i){return this.registerOrganizationUserCommand.execute({userData:i})}};t.\u0275fac=function(c){return new(c||t)(u(it),u(Ie))},t.\u0275prov=C({token:t,factory:t.\u0275fac});let e=t;return e})(),Gt=[tt,{provide:S,useExisting:tt}],Ot=(()=>{let t=class t extends A{constructor(){super(...arguments),this.responseStatus=Ee.CONFLICT}handleError(i,c){i&&this.getErrors(c)?.length&&this.globalMessageService.add({key:"userRegistrationForm.httpHandlers.conflict"},I.MSG_TYPE_ERROR)}getErrors(i){return(i.error?.errors).filter(c=>c?.type==="AlreadyExistsError")}getPriority(){return 0}};t.\u0275fac=(()=>{let i;return function(h){return(i||(i=K(t)))(h||t)}})(),t.\u0275prov=C({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})(),ot=(()=>{let t=class t{static forRoot(){return{ngModule:t,providers:[...Gt,it,{provide:A,useExisting:Ot,multi:!0}]}}};t.\u0275fac=function(c){return new(c||t)},t.\u0275mod=b({type:t}),t.\u0275inj=y({});let e=t;return e})();var Pt=(()=>{let t=class t{constructor(i,c,h){this.http=i,this.occEndpoints=c,this.converter=h,this.logger=q(de)}registerUser(i){let c=this.getOrganizationUserRegistrationEndpoint(),h=new se({"Content-Type":"application/json"});return h=fe.createHeader(ge,!0,h),i=this.converter.convert(i,rt),this.http.post(c,i,{headers:h}).pipe(k(R=>{throw _e(R,this.logger)}))}getOrganizationUserRegistrationEndpoint(){return this.occEndpoints.buildUrl("organizationUserRegistration")}};t.\u0275fac=function(c){return new(c||t)(u(ae),u(xe),u(Ce))},t.\u0275prov=C({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})(),kt={backend:{occ:{endpoints:{organizationUserRegistration:"/orgUsers"}}}},nt=(()=>{let t=class t{};t.\u0275fac=function(c){return new(c||t)},t.\u0275mod=b({type:t}),t.\u0275inj=y({providers:[le(kt),{provide:N,useExisting:Pt}],imports:[E]});let e=t;return e})();var Rr=(()=>{let t=class t{};t.\u0275fac=function(c){return new(c||t)},t.\u0275mod=b({type:t}),t.\u0275inj=y({imports:[ot.forRoot(),et,nt]});let e=t;return e})();export{Rr as OrganizationUserRegistrationModule};
